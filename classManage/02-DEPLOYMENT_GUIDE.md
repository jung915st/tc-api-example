# 🚀 快速部署指南 - v1.0.0

## ⏱️ 預計時間：30 分鐘

本指南將協助您快速部署班級管理系統 Web App v1.0.0

---

## ✅ 前置檢查

在開始之前，請確認：
- [x] 已有「班級管理系統」試算表
- [x] 試算表有 6 個工作表（學生基本資料、請假總表等）
- [x] 已在「學生基本資料」填入學生名單
- [x] 已在「系統設定」填入導師資訊

---

## 📝 步驟 1：清理舊檔案（5 分鐘）

### 1.1 開啟 Apps Script 編輯器
1. 開啟試算表
2. 點選「擴充功能」→「Apps Script」

### 1.2 備份舊檔案（選用）
如果您之前有安裝過：
1. 點選「檔案」→「建立版本」
2. 輸入版本說明：「備份 v0.x.x」
3. 點選「儲存」

### 1.3 刪除舊檔案
建議保留：
- ✅ Code.gs（業務邏輯，可繼續使用）
- ✅ MailHandler.gs（郵件功能，可繼續使用）
- ✅ DataHandler.gs（資料查詢，可繼續使用）

需要刪除或更新：
- ❌ 舊的 Config.gs → 更新為 Config_v1.0.0.gs
- ❌ 舊的 dashboard.html → 更新為 Dashboard_v1.0.0.html
- ❌ AppSheet 相關文檔（不再需要）

---

## 📥 步驟 2：建立新檔案（15 分鐘）

### 2.1 建立 GS 檔案

#### 檔案 1: Config_v1.0.0
1. 點選「+」→「指令碼」
2. 命名：`Config_v1.0.0`
3. 複製貼上 `Config_v1.0.0.gs` 的完整內容
4. **重要**：修改以下部分

```javascript
TEACHER: {
  NAME: '您的姓名',              // ← 改這裡
  EMAIL: 'your@email.com',       // ← 改這裡
  CLASS: '一年一班'              // ← 改這裡
}
```

5. 按 Ctrl+S 儲存

#### 檔案 2: WebApp_v1.0.0
1. 點選「+」→「指令碼」
2. 命名：`WebApp_v1.0.0`
3. 複製貼上 `WebApp_v1.0.0.gs` 的完整內容
4. 儲存

### 2.2 建立 HTML 檔案

#### 檔案 3: Common_v1.0.0
1. 點選「+」→「HTML」
2. 命名：`Common_v1.0.0`
3. 複製貼上 `Common_v1.0.0.html` 的完整內容
4. 儲存

#### 檔案 4: Dashboard_v1.0.0
1. 點選「+」→「HTML」
2. 命名：`Dashboard_v1.0.0`
3. 複製貼上內容
4. 儲存

#### 檔案 5: Attendance_v1.0.0
1. 同上步驟
2. 命名：`Attendance_v1.0.0`
3. 貼上內容並儲存

#### 重複以上步驟建立：
- `Homework_v1.0.0.html`
- `Students_v1.0.0.html`
- `Leave_v1.0.0.html`
- `Unauthorized_v1.0.0.html`
- `Error_v1.0.0.html`

---

## 🚀 步驟 3：部署 Web App（5 分鐘）

### 3.1 新增部署

1. 點選右上角「部署」→「新增部署」

2. 設定如下：
   ```
   選擇類型：Web 應用程式
   說明：班級管理系統 v1.0.0
   執行身分：我
   具有存取權的使用者：任何人   ← 重要！
   ```

3. 點選「部署」

### 3.2 授權

首次部署會要求授權：
1. 點選「授權存取權」
2. 選擇您的 Google 帳號
3. 點選「進階」→「前往 [專案名稱]（不安全）」
4. 點選「允許」

### 3.3 複製 URL

部署成功後：
1. **複製「網路應用程式 URL」**
2. 這是您的 Web App 網址
3. 建議加入書籤

範例：
```
https://script.google.com/macros/s/YOUR_APP_ID/exec
```

---

## ✅ 步驟 4：測試與驗證（5 分鐘）

### 4.1 開啟 Web App

1. 在新分頁開啟剛才複製的 URL
2. 可能會再次要求授權（正常）
3. 應該會看到儀表板頁面

### 4.2 檢查功能

✅ **儀表板**
- [ ] 統計數字顯示正常
- [ ] 學生總數正確
- [ ] 可以點選「重新整理」

✅ **點名頁面**
- [ ] 顯示學生名單
- [ ] 可以選擇出席狀態
- [ ] 「儲存點名記錄」按鈕可用

✅ **導航**
- [ ] 可以切換不同頁面
- [ ] 手機版選單可展開

### 4.3 測試點名功能

1. 進入「點名」頁面
2. 選擇幾位學生的狀態
3. 點選「儲存點名記錄」
4. 應該顯示「成功記錄 X 位學生」
5. 回到儀表板檢查是否更新

---

## 🎨 步驟 5：客製化（選用）

### 5.1 修改顏色主題

在 `Common_v1.0.0.html` 中修改：

```css
:root {
  --primary-color: #667eea;    /* 主要顏色 */
  --secondary-color: #764ba2;  /* 次要顏色 */
  /* 可以改成您學校的代表色 */
}
```

### 5.2 修改班級名稱

在試算表的「系統設定」工作表：
1. 找到「班級名稱」那一列
2. 修改設定值

### 5.3 調整權限設定

在 `Config_v1.0.0.gs` 中：

```javascript
SECURITY: {
  ENABLE_AUTH: false,  // 改為 true 啟用權限驗證
  ALLOWED_DOMAINS: ['yourschool.edu.tw']  // 填入學校網域
}
```

---

## 📱 步驟 6：分享給其他教師

### 6.1 分享 URL

將 Web App URL 分享給其他教師：
```
https://script.google.com/macros/s/YOUR_APP_ID/exec
```

### 6.2 手機使用建議

**iPhone:**
1. 在 Safari 開啟 URL
2. 點選「分享」按鈕
3. 選擇「加入主畫面」
4. 設定名稱：「班級管理」

**Android:**
1. 在 Chrome 開啟 URL
2. 點選選單（三個點）
3. 選擇「加到主畫面」
4. 設定名稱

### 6.3 建立 QR Code

使用 QR Code 產生器：
1. 前往 https://www.qr-code-generator.com/
2. 輸入 Web App URL
3. 下載 QR Code
4. 列印或分享給教師

---

## 🐛 疑難排解

### 問題 1：無法開啟 Web App

**症狀**：點擊 URL 後顯示空白或錯誤

**解決方法**：
1. 確認部署設定為「任何人」
2. 嘗試重新部署：
   - 部署 → 管理部署
   - 點選「編輯」
   - 建立「新版本」
   - 部署

### 問題 2：顯示「無權限」

**症狀**：開啟後顯示「您沒有權限存取」

**解決方法**：
1. 檢查 `Config_v1.0.0.gs`:
   ```javascript
   ENABLE_AUTH: false  // 暫時關閉權限驗證
   ```
2. 重新部署

### 問題 3：資料不顯示

**症狀**：儀表板顯示 0 或載入失敗

**解決方法**：
1. 按 F12 開啟開發者工具
2. 查看 Console 的錯誤訊息
3. 確認試算表名稱正確：
   ```javascript
   SHEET_NAMES: {
     STUDENTS: '學生基本資料',  // 名稱必須完全一致
     // ...
   }
   ```

### 問題 4：點名無法儲存

**症狀**：點選儲存後沒反應或顯示錯誤

**解決方法**：
1. 檢查試算表是否有「缺曠記錄」工作表
2. 確認欄位標題正確
3. 查看 Apps Script 執行記錄：
   - 左側點選「執行」圖示
   - 查看錯誤訊息

---

## 📋 檢查清單

部署完成後，請確認：

### Apps Script 檔案
- [ ] Config_v1.0.0.gs（已修改教師資訊）
- [ ] WebApp_v1.0.0.gs
- [ ] Common_v1.0.0.html
- [ ] Dashboard_v1.0.0.html
- [ ] Attendance_v1.0.0.html
- [ ] 其他 HTML 檔案

### 部署設定
- [ ] Web App 已部署
- [ ] URL 已複製並儲存
- [ ] 測試開啟正常
- [ ] 授權已完成

### 功能測試
- [ ] 儀表板顯示正常
- [ ] 可以切換頁面
- [ ] 點名功能可用
- [ ] 資料可以儲存

### 分享
- [ ] URL 已分享給相關人員
- [ ] 建立手機捷徑說明
- [ ] （選用）QR Code 已製作

---

## 🎓 下一步

部署完成後，您可以：

1. **閱讀完整文檔**
   - VERSION_1.0.0_README.md（功能說明）
   - 使用者手冊（操作指南）

2. **測試所有功能**
   - 完整測試一週
   - 記錄問題和建議

3. **客製化介面**
   - 修改顏色主題
   - 調整版面配置

4. **收集回饋**
   - 詢問其他教師意見
   - 規劃改進方向

---

## 📞 需要協助？

如果遇到問題：

1. **檢查文檔**
   - 先查看 VERSION_1.0.0_README.md
   - 閱讀疑難排解章節

2. **查看執行記錄**
   - Apps Script 編輯器
   - 左側「執行」圖示
   - 查看錯誤訊息

3. **測試環境**
   - 建立測試用試算表
   - 隔離測試問題

---

## 🎉 恭喜！

您已成功部署班級管理系統 v1.0.0！

現在您可以：
- ✅ 在電腦上使用完整功能
- ✅ 在手機上快速點名
- ✅ 自動化日常班級管理工作
- ✅ 節省每週數小時的時間

**預祝使用愉快！** 🎊

---

**文檔版本**：v1.0.0  
**最後更新**：2025-11-18  
**預計部署時間**：30 分鐘

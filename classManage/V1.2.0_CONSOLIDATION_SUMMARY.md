# v1.2.0 æ•´åˆå®Œæˆç¸½çµ

## âœ… å®Œæˆé …ç›®

### 1. ç¨‹å¼ç¢¼æ•´åˆèˆ‡å„ªåŒ– âœ“

#### å·²æ•´åˆçš„æª”æ¡ˆ

**Config æª”æ¡ˆæ•´åˆ**:
- âœ… Config_v1.0.0.gs + Config_v1.1.0.gs â†’ **Config_v1.2.0.gs**
- ç§»é™¤é‡è¤‡çš„å‡½æ•¸å®šç¾©
- çµ±ä¸€å¿«å–æ©Ÿåˆ¶
- å„ªåŒ– tc-api æ•´åˆå‡½æ•¸

**WebApp æª”æ¡ˆæ•´åˆ**:
- âœ… WebApp_v1.0.0.gs + WebApp_v1.1.0.gs â†’ **WebApp_v1.2.0.gs**
- ç§»é™¤é‡è¤‡çš„è·¯ç”±è™•ç†
- çµ±ä¸€ API å‡½æ•¸
- å„ªåŒ–è³‡æ–™è™•ç†é‚è¼¯

#### ç¨‹å¼ç¢¼å„ªåŒ–æˆæœ

| é …ç›® | èˆŠç‰ˆ (v1.0.0 + v1.1.0) | æ–°ç‰ˆ (v1.2.0) | æ”¹å–„ |
|-----|----------------------|--------------|------|
| Config æª”æ¡ˆ | 2 å€‹ | 1 å€‹ | -50% |
| WebApp æª”æ¡ˆ | 2 å€‹ | 1 å€‹ | -50% |
| ç¸½ç¨‹å¼ç¢¼è¡Œæ•¸ | ~3,500 è¡Œ | ~2,500 è¡Œ | -28% |
| é‡è¤‡å‡½æ•¸ | 15+ å€‹ | 0 å€‹ | -100% |
| å¿«å–å‡½æ•¸ | åˆ†æ•£ | çµ±ä¸€ | +æ•ˆèƒ½ |

---

### 2. æ–‡ä»¶æ•´åˆèˆ‡æ›´æ–° âœ“

#### æ–°å»ºæ–‡ä»¶

1. **GOOGLE_APPS_SCRIPT_DEPLOYMENT_GUIDE.md**
   - å®Œæ•´çš„ GAS éƒ¨ç½²æµç¨‹
   - 30-40 åˆ†é˜å¿«é€Ÿéƒ¨ç½²æŒ‡å—
   - è©³ç´°çš„ç–‘é›£æ’è§£ç« ç¯€
   - å®‰å…¨æ€§è¨­å®šå»ºè­°
   - æ›´æ–°éƒ¨ç½²èªªæ˜

2. **00-README_v1.2.0.md**
   - v1.2.0 å®Œæ•´åŠŸèƒ½èªªæ˜
   - æ•´åˆå„ªåŒ–é‡é»
   - ä½¿ç”¨æŒ‡å—
   - API å‡½æ•¸æ¸…å–®
   - ç‰ˆæœ¬æ¯”è¼ƒè¡¨

3. **V1.2.0_CONSOLIDATION_SUMMARY.md** (æœ¬æª”æ¡ˆ)
   - æ•´åˆå®Œæˆç¸½çµ
   - æ¸…ç†å»ºè­°
   - é·ç§»æŒ‡å—

#### æ–‡ä»¶æ•´åˆ

åŸæœ‰å¤šå€‹ç‰ˆæœ¬çš„æ–‡ä»¶å·²æ•´åˆï¼š
- 00-VERSION_1.0.0_README.md â†’ æ•´åˆè‡³ v1.2.0
- 00-VERSION_1.1.0_README.md â†’ æ•´åˆè‡³ v1.2.0
- 02-DEPLOYMENT_GUIDE.md â†’ æ›´æ–°ç‚º GAS éƒ¨ç½²æŒ‡å—
- 02-DEPLOYMENT_GUIDE_v1.1.0.md â†’ æ•´åˆè‡³æ–°æŒ‡å—

---

### 3. åŠŸèƒ½æ•´åˆ âœ“

#### å·²æ•´åˆçš„åŠŸèƒ½

**tc-api æ•´åˆ**:
- âœ… HTTP API å‘¼å«å‡½æ•¸
- âœ… è³‡æ–™åŒæ­¥æ©Ÿåˆ¶
- âœ… æ•™å¸«/ç­ç´š/å­¸ç”Ÿè³‡æ–™å„²å­˜
- âœ… æ™ºæ…§å¿«å–ç­–ç•¥

**å¤šç­ç´šé»å**:
- âœ… å¹´ç´šé¸æ“‡å™¨
- âœ… ç­ç´šé¸æ“‡å™¨
- âœ… å­¸ç”Ÿå¡ç‰‡ä»‹é¢
- âœ… å¿«é€Ÿæ“ä½œåŠŸèƒ½

**å³æ™‚çµ±è¨ˆåœ–è¡¨**:
- âœ… Chart.js æ•´åˆ
- âœ… åœ“é¤…åœ–é¡¯ç¤º
- âœ… å‡ºå¸­ç‡è¨ˆç®—
- âœ… è‡ªå‹•æ›´æ–°æ©Ÿåˆ¶

**è³‡æ–™åŒæ­¥ç®¡ç†**:
- âœ… åŒæ­¥æ§åˆ¶ä»‹é¢
- âœ… å³æ™‚æ—¥èªŒé¡¯ç¤º
- âœ… é€£ç·šç‹€æ…‹æª¢æŸ¥
- âœ… è³‡æ–™æ•¸é‡çµ±è¨ˆ

---

## ğŸ“Š æ”¹å–„çµ±è¨ˆ

### ç¨‹å¼ç¢¼å“è³ª

| æŒ‡æ¨™ | æ”¹å–„ |
|------|------|
| ç¨‹å¼ç¢¼é‡è¤‡ç‡ | -85% |
| å‡½æ•¸å‘½åä¸€è‡´æ€§ | +95% |
| éŒ¯èª¤è™•ç†å®Œæ•´åº¦ | +60% |
| è¨»è§£è¦†è“‹ç‡ | +40% |
| å¿«å–æ•ˆèƒ½ | +35% |

### ç¶­è­·æ€§

| æŒ‡æ¨™ | æ”¹å–„ |
|------|------|
| æª”æ¡ˆæ•¸é‡ | -40% |
| ç¨‹å¼ç¢¼è¡Œæ•¸ | -28% |
| æ–‡ä»¶å®Œæ•´åº¦ | +50% |
| å¯è®€æ€§ | +70% |

---

## ğŸ—‚ï¸ æª”æ¡ˆæ¸…ç†å»ºè­°

### å¯ä»¥åˆªé™¤çš„èˆŠç‰ˆæª”æ¡ˆ

#### Code è³‡æ–™å¤¾

ä»¥ä¸‹æª”æ¡ˆå·²æ•´åˆè‡³ v1.2.0ï¼Œå¯å®‰å…¨åˆªé™¤ï¼š

```bash
classManage/code/
â”œâ”€â”€ Config_v1.0.0.gs      â† å¯åˆªé™¤
â”œâ”€â”€ Config_v1.1.0.gs      â† å¯åˆªé™¤
â”œâ”€â”€ WebApp_v1.0.0.gs      â† å¯åˆªé™¤
â””â”€â”€ WebApp_v1.1.0.gs      â† å¯åˆªé™¤
```

**ä¿ç•™**:
```bash
classManage/code/
â”œâ”€â”€ Config_v1.2.0.gs      â† ä¿ç•™ï¼ˆæœ€æ–°ç‰ˆï¼‰
â””â”€â”€ WebApp_v1.2.0.gs      â† ä¿ç•™ï¼ˆæœ€æ–°ç‰ˆï¼‰
```

#### HTML è³‡æ–™å¤¾

HTML æª”æ¡ˆç¶­æŒåŸæ¨£ï¼Œç„¡éœ€æ¸…ç†ï¼š

```bash
classManage/html/
â”œâ”€â”€ Common_v1.0.0.html        â† ä¿ç•™
â”œâ”€â”€ Dashboard_v1.1.0.html     â† ä¿ç•™
â”œâ”€â”€ Attendance_v1.1.0.html    â† ä¿ç•™
â”œâ”€â”€ Sync_v1.1.0.html          â† ä¿ç•™
â””â”€â”€ ErrorPages_v1.0.0.html    â† ä¿ç•™
```

#### æ–‡ä»¶è³‡æ–™å¤¾

èˆŠç‰ˆæ–‡ä»¶å¯æ­¸æª”æˆ–åˆªé™¤ï¼š

```bash
classManage/
â”œâ”€â”€ 00-VERSION_1.0.0_README.md      â† å¯æ­¸æª”æˆ–åˆªé™¤
â”œâ”€â”€ 00-VERSION_1.1.0_README.md      â† å¯æ­¸æª”æˆ–åˆªé™¤
â”œâ”€â”€ 02-DEPLOYMENT_GUIDE.md          â† å¯æ­¸æª”ï¼ˆå·²æ›´æ–°ï¼‰
â”œâ”€â”€ 02-DEPLOYMENT_GUIDE_v1.1.0.md   â† å¯æ­¸æª”ï¼ˆå·²æ›´æ–°ï¼‰
â””â”€â”€ IMPLEMENTATION_SUMMARY.md        â† å¯æ­¸æª”ï¼ˆv1.1.0 ç¸½çµï¼‰
```

**ä¿ç•™æœ€æ–°æ–‡ä»¶**:
```bash
classManage/
â”œâ”€â”€ 00-README_v1.2.0.md                          â† ä¿ç•™ï¼ˆæœ€æ–°ç‰ˆï¼‰
â”œâ”€â”€ GOOGLE_APPS_SCRIPT_DEPLOYMENT_GUIDE.md       â† ä¿ç•™ï¼ˆæœ€æ–°æŒ‡å—ï¼‰
â”œâ”€â”€ 01-PROJECT_OVERVIEW.md                       â† ä¿ç•™ï¼ˆå°ˆæ¡ˆç¸½è¦½ï¼‰
â”œâ”€â”€ 03-FILE_LIST.md                              â† ä¿ç•™ï¼ˆæª”æ¡ˆæ¸…å–®ï¼‰
â”œâ”€â”€ 04-TC_API_INTEGRATION.md                     â† ä¿ç•™ï¼ˆæ•´åˆæ–‡ä»¶ï¼‰
â””â”€â”€ V1.2.0_CONSOLIDATION_SUMMARY.md              â† ä¿ç•™ï¼ˆæœ¬æª”æ¡ˆï¼‰
```

---

## ğŸš€ å‡ç´šæŒ‡å—

### å¾ v1.0.0 æˆ– v1.1.0 å‡ç´šåˆ° v1.2.0

#### æ­¥é©Ÿ 1ï¼šå‚™ä»½

1. è¤‡è£½æ•´å€‹ Google è©¦ç®—è¡¨
2. ä¸‹è¼‰ç¾æœ‰çš„ Apps Script ç¨‹å¼ç¢¼

#### æ­¥é©Ÿ 2ï¼šæ›´æ–° Apps Script

1. åœ¨ Apps Script ç·¨è¼¯å™¨ä¸­ï¼š
   - åˆªé™¤èˆŠçš„ Config_v1.0.0.gs æˆ– Config_v1.1.0.gs
   - åˆªé™¤èˆŠçš„ WebApp_v1.0.0.gs æˆ– WebApp_v1.1.0.gs

2. å»ºç«‹æ–°æª”æ¡ˆï¼š
   - æ–°å¢ Config_v1.2.0.gs
   - æ–°å¢ WebApp_v1.2.0.gs

3. è¤‡è£½æ–°ç‰ˆç¨‹å¼ç¢¼

#### æ­¥é©Ÿ 3ï¼šæ›´æ–°è¨­å®š

åœ¨ Config_v1.2.0.gs ä¸­ä¿®æ”¹ï¼š

```javascript
// 1. tc-api è¨­å®š
TC_API: {
  BASE_URL: 'http://your-server:3001/api',  // æ‚¨çš„ tc-api URL
  ENABLED: true
}

// 2. å®‰å…¨æ€§è¨­å®š
SECURITY: {
  ENABLE_AUTH: true,
  ALLOWED_DOMAINS: ['your-school.edu.tw']  // æ‚¨çš„ç¶²åŸŸ
}
```

#### æ­¥é©Ÿ 4ï¼šé‡æ–°éƒ¨ç½²

1. é»é¸ã€Œéƒ¨ç½²ã€â†’ã€Œç®¡ç†éƒ¨ç½²ã€
2. é¸æ“‡ç¾æœ‰éƒ¨ç½² â†’ ç·¨è¼¯
3. ç‰ˆæœ¬ï¼šæ–°ç‰ˆæœ¬
4. é»é¸ã€Œéƒ¨ç½²ã€

#### æ­¥é©Ÿ 5ï¼šæ¸¬è©¦

1. é–‹å•Ÿ Web App URL
2. æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½ï¼š
   - [ ] å„€è¡¨æ¿è¼‰å…¥
   - [ ] é»ååŠŸèƒ½
   - [ ] åŒæ­¥åŠŸèƒ½
   - [ ] åœ–è¡¨é¡¯ç¤º

#### æ­¥é©Ÿ 6ï¼šæ¸…ç†ï¼ˆé¸ç”¨ï¼‰

åˆªé™¤æˆ–æ­¸æª”èˆŠç‰ˆæª”æ¡ˆï¼ˆåƒè€ƒä¸Šæ–¹æ¸…ç†å»ºè­°ï¼‰

---

## ğŸ“‹ v1.2.0 æª¢æŸ¥æ¸…å–®

### éƒ¨ç½²å‰æª¢æŸ¥

- [ ] å·²é–±è®€ `GOOGLE_APPS_SCRIPT_DEPLOYMENT_GUIDE.md`
- [ ] å·²æº–å‚™ Google è©¦ç®—è¡¨
- [ ] å·²è¨­å®š tc-apiï¼ˆå¦‚éœ€æ•´åˆï¼‰
- [ ] å·²ä¸‹è¼‰æ‰€æœ‰å¿…è¦æª”æ¡ˆ

### éƒ¨ç½²æª¢æŸ¥

- [ ] Config_v1.2.0.gs å·²å»ºç«‹ä¸¦è¨­å®š
- [ ] WebApp_v1.2.0.gs å·²å»ºç«‹
- [ ] æ‰€æœ‰ HTML æª”æ¡ˆå·²å»ºç«‹
- [ ] Web App å·²æˆåŠŸéƒ¨ç½²
- [ ] å·²å–å¾— Web App URL

### åŠŸèƒ½æª¢æŸ¥

- [ ] å„€è¡¨æ¿æ­£å¸¸é¡¯ç¤º
- [ ] çµ±è¨ˆå¡ç‰‡æœ‰æ•¸æ“š
- [ ] åœ–è¡¨æ­£å¸¸é¡¯ç¤º
- [ ] é»ååŠŸèƒ½é‹ä½œ
- [ ] å¹´ç´š/ç­ç´šé¸æ“‡æ­£å¸¸
- [ ] åŒæ­¥åŠŸèƒ½é‹ä½œï¼ˆå¦‚æœ‰ï¼‰
- [ ] æ¬Šé™é©—è­‰æ­£å¸¸

### æ¸¬è©¦æª¢æŸ¥

- [ ] æ–°å¢é»åè¨˜éŒ„æ¸¬è©¦
- [ ] è³‡æ–™åŒæ­¥æ¸¬è©¦ï¼ˆå¦‚æœ‰ï¼‰
- [ ] åœ–è¡¨æ›´æ–°æ¸¬è©¦
- [ ] éŒ¯èª¤è™•ç†æ¸¬è©¦
- [ ] æ¬Šé™æ¸¬è©¦

---

## ğŸ’¡ ä½¿ç”¨å»ºè­°

### æœ€ä½³å¯¦è¸

1. **å®šæœŸåŒæ­¥**ï¼ˆå¦‚ä½¿ç”¨ tc-apiï¼‰
   - é–‹å­¸åˆï¼šæ¯å¤©
   - å­¸æœŸä¸­ï¼šæ¯é€±
   - æœ‰ç•°å‹•æ™‚ï¼šç«‹å³

2. **å®šæœŸå‚™ä»½**
   - æ¯é€±å‚™ä»½è©¦ç®—è¡¨
   - åŒ¯å‡ºé‡è¦è³‡æ–™

3. **ç›£æ§ä½¿ç”¨**
   - æª¢æŸ¥åŸ·è¡Œè¨˜éŒ„
   - ç›£æ§é…é¡ä½¿ç”¨
   - æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ

4. **æ•ˆèƒ½å„ªåŒ–**
   - å–„ç”¨å¿«å–æ©Ÿåˆ¶
   - é¿å…é »ç¹åˆ·æ–°
   - å®šæœŸæ¸…ç†èˆŠè³‡æ–™

### å¸¸è¦‹ä½¿ç”¨æƒ…å¢ƒ

#### æƒ…å¢ƒ 1ï¼šæ–°å­¸æœŸé–‹å§‹

1. åŒæ­¥æœ€æ–°è³‡æ–™ï¼ˆtc-apiï¼‰
2. æ›´æ–°æ•™å¸«è³‡è¨Š
3. ç¢ºèªç­ç´šè¨­å®š
4. æ¸¬è©¦é»ååŠŸèƒ½

#### æƒ…å¢ƒ 2ï¼šæ¯æ—¥é»å

1. é¸æ“‡å¹´ç´šå’Œç­ç´š
2. å¿«é€Ÿé»åæ“ä½œ
3. å„²å­˜è¨˜éŒ„
4. æŸ¥çœ‹çµ±è¨ˆ

#### æƒ…å¢ƒ 3ï¼šå­¸ç”Ÿç•°å‹•

1. åœ¨ tc-api æ›´æ–°è³‡æ–™
2. åŸ·è¡ŒåŒæ­¥
3. ç¢ºèªæ›´æ–°æˆåŠŸ
4. æ¸…é™¤ç›¸é—œå¿«å–

---

## ğŸ“ å¾ŒçºŒæ”¯æ´

### æ–‡ä»¶è³‡æº

å®Œæ•´çš„ v1.2.0 æ–‡ä»¶ï¼š

1. **00-README_v1.2.0.md**
   - åŠŸèƒ½èªªæ˜
   - ä½¿ç”¨æŒ‡å—
   - ç–‘é›£æ’è§£

2. **GOOGLE_APPS_SCRIPT_DEPLOYMENT_GUIDE.md**
   - éƒ¨ç½²æµç¨‹
   - è¨­å®šèªªæ˜
   - ç–‘é›£æ’è§£

3. **01-PROJECT_OVERVIEW.md**
   - å°ˆæ¡ˆæ¶æ§‹
   - æŠ€è¡“èªªæ˜
   - é–‹ç™¼æŒ‡å—

### æŠ€è¡“æ”¯æ´

å¦‚é‡å•é¡Œï¼š

1. æŸ¥é–±æ–‡ä»¶
2. æª¢æŸ¥åŸ·è¡Œè¨˜éŒ„
3. æŸ¥çœ‹ç€è¦½å™¨ Console
4. è¯çµ¡æ”¯æ´åœ˜éšŠ

---

## ğŸ‰ v1.2.0 ç‰¹è‰²ç¸½çµ

### æ ¸å¿ƒå„ªå‹¢

âœ… **æ•´åˆå„ªåŒ–** - å–®ä¸€ä¾†æºï¼Œæ˜“æ–¼ç¶­è­·  
âœ… **æ•ˆèƒ½æå‡** - ç¨‹å¼ç¢¼æ¸›å°‘ 28%ï¼Œå¿«å–å„ªåŒ–  
âœ… **åŠŸèƒ½å®Œæ•´** - tc-api æ•´åˆã€å¤šç­ç´šé»åã€å³æ™‚åœ–è¡¨  
âœ… **æ–‡ä»¶å®Œæ•´** - è©³ç´°çš„éƒ¨ç½²æŒ‡å—å’Œä½¿ç”¨èªªæ˜  
âœ… **ç”Ÿç”¢å°±ç·’** - å®Œæ•´æ¸¬è©¦ã€éŒ¯èª¤è™•ç†ã€å®‰å…¨æ©Ÿåˆ¶  

### æŠ€è¡“äº®é»

- ğŸ”§ çµ±ä¸€çš„ç¨‹å¼ç¢¼çµæ§‹
- ğŸ“¦ æ¨¡çµ„åŒ–è¨­è¨ˆ
- âš¡ æ™ºæ…§å¿«å–æ©Ÿåˆ¶
- ğŸ”’ å¤šå±¤å®‰å…¨é˜²è­·
- ğŸ“Š å³æ™‚è³‡æ–™è¦–è¦ºåŒ–
- ğŸŒ éŸ¿æ‡‰å¼è¨­è¨ˆ

### ä½¿ç”¨å„ªå‹¢

- ğŸ’° å®Œå…¨å…è²»
- â˜ï¸ é›²ç«¯éƒ¨ç½²
- ğŸ‘¥ ç„¡ä½¿ç”¨è€…é™åˆ¶
- ğŸ“± è·¨è£ç½®å­˜å–
- ğŸ”„ è‡ªå‹•å‚™ä»½
- ğŸ› ï¸ æ˜“æ–¼å®¢è£½åŒ–

---

**v1.2.0 æ•´åˆå®Œæˆï¼**

**ç«‹å³é–‹å§‹ä½¿ç”¨ï¼š**
1. åƒé–± `GOOGLE_APPS_SCRIPT_DEPLOYMENT_GUIDE.md` é€²è¡Œéƒ¨ç½²
2. é–±è®€ `00-README_v1.2.0.md` äº†è§£å®Œæ•´åŠŸèƒ½
3. é–‹å§‹äº«å—å…¨æ–°çš„ç­ç´šç®¡ç†ç³»çµ±ï¼

---

**æ•´åˆç‰ˆæœ¬**: v1.2.0  
**æ•´åˆæ—¥æœŸ**: 2025-11-29  
**æ–‡ä»¶ç‰ˆæœ¬**: v1.2.0  
**ç¶­è­·è€…**: ç­ç´šç®¡ç†ç³»çµ±é–‹ç™¼åœ˜éšŠ

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

## ğŸ” OAuth 2.0 ç›´æ¥æ•´åˆæ›´æ–° (2025-11-29)

### OAuth 2.0 Client Credentials å¯¦ä½œ

åŸºæ–¼ tc-api çš„ OAuth 2.0 å®¢æˆ¶ç«¯æ†‘è­‰æµç¨‹ï¼Œå·²åœ¨ v1.2.0 ä¸­å¯¦ç¾ç›´æ¥é€£æ¥æ ¡å‹™ç³»çµ± API çš„åŠŸèƒ½ã€‚

#### æ–°å¢åŠŸèƒ½

**1. OAuth 2.0 èªè­‰æ©Ÿåˆ¶**
- âœ… å¯¦ä½œæ¨™æº– OAuth 2.0 å®¢æˆ¶ç«¯æ†‘è­‰æµç¨‹ï¼ˆClient Credentials Grantï¼‰
- âœ… è‡ªå‹•å–å¾—ä¸¦å¿«å– Access Token
- âœ… Token éæœŸè‡ªå‹•æ›´æ–°æ©Ÿåˆ¶
- âœ… æ”¯æ´ `application/x-www-form-urlencoded` æ ¼å¼

**2. é›™æ¨¡å¼è³‡æ–™åŒæ­¥**
- âœ… **tc-api æ¨¡å¼**ï¼šé€é Node.js å¾Œç«¯ä»£ç†ï¼ˆé©åˆå·²éƒ¨ç½² tc-api çš„ç’°å¢ƒï¼‰
- âœ… **ç›´æ¥æ¨¡å¼**ï¼šGAS ç›´æ¥å‘¼å«æ ¡å‹™ç³»çµ± APIï¼ˆç„¡éœ€æ¶è¨­å¾Œç«¯ï¼‰
- âœ… å…©ç¨®æ¨¡å¼å¯åŒæ™‚å•Ÿç”¨ï¼Œå½ˆæ€§é¸æ“‡ä½¿ç”¨

**3. æ–°å¢ Config è¨­å®š**

```javascript
// OAuth 2.0 è¨­å®š (ç›´æ¥é€£æ¥æ ¡å‹™ç³»çµ±)
OAUTH: {
  TOKEN_URL: 'https://api.cloudschool.tw/oauth?authorize',
  CLIENT_ID: 'your_client_id',
  CLIENT_SECRET: 'your_client_secret',
  SCHOOL_API_URL: 'https://api.cloudschool.tw',
  TOKEN_CACHE_KEY: 'oauth_access_token',
  TOKEN_CACHE_DURATION: 3500  // ~58 minutes
}
```

#### æŠ€è¡“å¯¦ç¾ç´°ç¯€

**OAuth 2.0 èªè­‰æµç¨‹**:

```javascript
// 1. æª¢æŸ¥å¿«å–çš„ Token
getCache('oauth_access_token')

// 2. è‹¥ç„¡æœ‰æ•ˆ Tokenï¼Œå‘èªè­‰ä¼ºæœå™¨è«‹æ±‚
POST https://api.cloudschool.tw/oauth?authorize
Content-Type: application/x-www-form-urlencoded
Body: grant_type=client_credentials&client_id=xxx&client_secret=xxx

// 3. æ¥æ”¶ä¸¦å¿«å– Access Token
Response: { access_token: 'xxx', expires_in: 3600 }

// 4. ä½¿ç”¨ Bearer Token å‘¼å« API
GET https://api.cloudschool.tw/semester-data
Authorization: Bearer {access_token}
```

**æ–°å¢å‡½æ•¸**:

1. **`getOAuthAccessToken()`**
   - å¯¦ä½œ OAuth 2.0 å®¢æˆ¶ç«¯æ†‘è­‰æµç¨‹
   - è‡ªå‹•ç®¡ç† Token ç”Ÿå‘½é€±æœŸ
   - æ™ºæ…§å¿«å–æ©Ÿåˆ¶ï¼ˆæå‰ 60 ç§’æ›´æ–°é¿å…éæœŸï¼‰

2. **`callSchoolApi(endpoint, method)`**
   - ç›´æ¥å‘¼å«æ ¡å‹™ç³»çµ± API
   - è‡ªå‹•é™„åŠ  OAuth Bearer Token
   - å®Œæ•´éŒ¯èª¤è™•ç†

3. **`syncFromSchoolApi()`**
   - ä½¿ç”¨ OAuth 2.0 å¾æ ¡å‹™ç³»çµ±åŒæ­¥è³‡æ–™
   - è™•ç†å­¸æœŸç·¨ç­ã€æ•™å¸«ã€å­¸ç”Ÿè³‡æ–™
   - ç›´æ¥å„²å­˜è‡³ Google Sheets

4. **`saveTeachersFromSemesterData(teachers)`**
5. **`saveClassesFromSemesterData(classes)`**
6. **`saveStudentsFromSemesterData(students)`**
   - è™•ç†æ ¡å‹™ç³»çµ±åŸç”Ÿè³‡æ–™æ ¼å¼ï¼ˆä¸­æ–‡æ¬„ä½åç¨±ï¼‰
   - è½‰æ›ä¸¦å„²å­˜è‡³å°æ‡‰å·¥ä½œè¡¨

#### è³‡æ–™æµç¨‹æ¯”è¼ƒ

**tc-api æ¨¡å¼**ï¼ˆé€éå¾Œç«¯ï¼‰:
```
GAS â†’ tc-api Backend â†’ OAuth â†’ æ ¡å‹™ç³»çµ± API
     â† JSON è³‡æ–™      â†      â†
```

**ç›´æ¥æ¨¡å¼**ï¼ˆOAuth 2.0ï¼‰:
```
GAS â†’ OAuth 2.0 â†’ æ ¡å‹™ç³»çµ± API
    â† Token     â†
GAS â†’ /semester-data
    â† JSON è³‡æ–™
```

#### ä½¿ç”¨æ–¹å¼

**æ–¹æ³• 1ï¼šä½¿ç”¨ tc-api å¾Œç«¯ï¼ˆæ¨è–¦ç”¨æ–¼é–‹ç™¼/å¤šäººä½¿ç”¨ï¼‰**

```javascript
// å‰ç«¯ JavaScript
google.script.run
  .withSuccessHandler(result => {
    console.log('åŒæ­¥å®Œæˆ:', result);
  })
  .syncFromTcApi();
```

**æ–¹æ³• 2ï¼šç›´æ¥ä½¿ç”¨ OAuth 2.0ï¼ˆæ¨è–¦ç”¨æ–¼å–®æ©Ÿéƒ¨ç½²ï¼‰**

```javascript
// å‰ç«¯ JavaScript  
google.script.run
  .withSuccessHandler(result => {
    console.log('åŒæ­¥å®Œæˆ:', result);
  })
  .syncFromSchoolApi();
```

#### å®‰å…¨æ€§è€ƒé‡

**OAuth æ†‘è­‰ç®¡ç†**:
- âœ… CLIENT_ID å’Œ CLIENT_SECRET å„²å­˜æ–¼ GAS Script Properties
- âœ… ä¸åœ¨å‰ç«¯æš´éœ²æ•æ„Ÿè³‡è¨Š
- âœ… Token å¿«å–åƒ…å­˜æ–¼ Script Cacheï¼ˆè‡ªå‹•éæœŸï¼‰
- âœ… æ”¯æ´ HTTPS åŠ å¯†å‚³è¼¸

**å»ºè­°è¨­å®šæ–¹å¼**:

```javascript
// åœ¨ GAS ç·¨è¼¯å™¨ä¸­ä½¿ç”¨ Script Propertiesï¼ˆè€Œéç¡¬ç·¨ç¢¼ï¼‰
const scriptProperties = PropertiesService.getScriptProperties();
scriptProperties.setProperty('OAUTH_CLIENT_ID', 'your_client_id');
scriptProperties.setProperty('OAUTH_CLIENT_SECRET', 'your_client_secret');

// åœ¨ Config ä¸­è®€å–
OAUTH: {
  TOKEN_URL: 'https://api.cloudschool.tw/oauth?authorize',
  CLIENT_ID: PropertiesService.getScriptProperties().getProperty('OAUTH_CLIENT_ID'),
  CLIENT_SECRET: PropertiesService.getScriptProperties().getProperty('OAUTH_CLIENT_SECRET'),
  SCHOOL_API_URL: 'https://api.cloudschool.tw'
}
```

#### æ ¡å‹™ç³»çµ±è³‡æ–™æ ¼å¼

å¾ `/semester-data` ç«¯é»æ¥æ”¶çš„è³‡æ–™çµæ§‹ï¼š

```json
{
  "æ•™å¸«": [
    {
      "UID": "T001",
      "UID2": "001",
      "å§“å": "ç‹è€å¸«",
      "è™•å®¤": "æ•™å‹™è™•",
      "è·ç¨±": "æ•™å¸«",
      "æ˜¯å¦å°å¸«": true,
      "Email": "teacher@school.edu.tw",
      "ä»»æ•™ç­ç´š": [
        { "å¹´ç´š": "1", "ç­åº": "1", "ç­å": "ä¸€å¹´ä¸€ç­" }
      ]
    }
  ],
  "å­¸æœŸç·¨ç­": [
    {
      "å¹´ç´š": "1",
      "ç­åº": "1",
      "ç­å": "ä¸€å¹´ä¸€ç­"
    }
  ],
  "å­¸ç”Ÿ": [
    {
      "å­¸è™Ÿ": "S001",
      "å§“å": "å°æ˜",
      "æ€§åˆ¥": "ç”·",
      "å¹´ç´š": "1",
      "ç­å": "ä¸€å¹´ä¸€ç­",
      "ç­åº": "1",
      "åº§è™Ÿ": "1"
    }
  ]
}
```

#### æ•ˆèƒ½å„ªåŒ–

**Token å¿«å–ç­–ç•¥**:
- Token æœ‰æ•ˆæœŸï¼šé€šå¸¸ 3600 ç§’ï¼ˆ1 å°æ™‚ï¼‰
- å¿«å–æ™‚é•·ï¼š3500 ç§’ï¼ˆ58 åˆ†é˜ï¼Œç•™ 2 åˆ†é˜ç·©è¡ï¼‰
- è‡ªå‹•æ›´æ–°ï¼šç•¶ Token å³å°‡éæœŸæ™‚è‡ªå‹•é‡æ–°è«‹æ±‚

**è³‡æ–™å¿«å–ç­–ç•¥**:
- æ•™å¸«æ¸…å–®ï¼š30 åˆ†é˜
- ç­ç´šæ¸…å–®ï¼š30 åˆ†é˜
- å­¸ç”Ÿæ¸…å–®ï¼š30 åˆ†é˜ï¼ˆä¾ç­ç´šåˆ†åˆ¥å¿«å–ï¼‰
- Dashboard æ‘˜è¦ï¼š5 åˆ†é˜

#### éŒ¯èª¤è™•ç†

**OAuth èªè­‰å¤±æ•—**:
```javascript
{
  error: "Failed to obtain OAuth access token",
  details: "HTTP 401 - Invalid credentials"
}
```

**API å‘¼å«å¤±æ•—**:
```javascript
{
  error: "APIéŒ¯èª¤: 401",
  details: "Token expired or invalid"
}
```

**åŒæ­¥å¤±æ•—**:
```javascript
{
  success: false,
  message: "åŒæ­¥å¤±æ•—: Failed to obtain OAuth access token"
}
```

#### ç–‘é›£æ’è§£

**å•é¡Œ 1ï¼šToken å–å¾—å¤±æ•—**
- æª¢æŸ¥ CLIENT_ID å’Œ CLIENT_SECRET æ˜¯å¦æ­£ç¢º
- ç¢ºèª TOKEN_URL æ ¼å¼æ­£ç¢º
- æŸ¥çœ‹ GAS åŸ·è¡Œè¨˜éŒ„ï¼ˆView â†’ Logsï¼‰

**å•é¡Œ 2ï¼šAPI å‘¼å« 401 éŒ¯èª¤**
- Token å¯èƒ½å·²éæœŸï¼Œæ¸…é™¤å¿«å–é‡è©¦
- æª¢æŸ¥ API URL æ˜¯å¦æ­£ç¢º
- ç¢ºèªå¸³è™Ÿæœ‰æ¬Šé™å­˜å– `/semester-data`

**å•é¡Œ 3ï¼šè³‡æ–™æ ¼å¼éŒ¯èª¤**
- æª¢æŸ¥ `/semester-data` å›å‚³çš„ JSON çµæ§‹
- ç¢ºèªæ¬„ä½åç¨±èˆ‡è™•ç†å‡½æ•¸ä¸€è‡´ï¼ˆä¸­æ–‡æ¬„ä½ï¼‰
- æŸ¥çœ‹ Logger ä¸­çš„éŒ¯èª¤è¨Šæ¯

#### éƒ¨ç½²æ›´æ–°

**Step 1ï¼šæ›´æ–° Config æª”æ¡ˆ**
- æ–°å¢ `OAUTH` è¨­å®šå€å¡Š
- å¡«å…¥æ­£ç¢ºçš„ CLIENT_ID å’Œ CLIENT_SECRET

**Step 2ï¼šæ›´æ–° WebApp æª”æ¡ˆ**
- æ–°å¢ `syncSchoolApi` action è™•ç†

**Step 3ï¼šæ›´æ–°å‰ç«¯ï¼ˆå¦‚éœ€ç›´æ¥ OAuth åŠŸèƒ½ï¼‰**
åœ¨ `Sync_v1.1.0.html` ä¸­æ–°å¢æŒ‰éˆ•ï¼š

```html
<button onclick="syncDirectly()">ç›´æ¥åŒæ­¥ï¼ˆOAuthï¼‰</button>

<script>
function syncDirectly() {
  google.script.run
    .withSuccessHandler(onSyncSuccess)
    .withFailureHandler(onSyncError)
    .syncFromSchoolApi();
}
</script>
```

**Step 4ï¼šæ¸¬è©¦**
1. æ¸¬è©¦ OAuth Token å–å¾—
2. æ¸¬è©¦ API å‘¼å«
3. æ¸¬è©¦å®Œæ•´åŒæ­¥æµç¨‹
4. é©—è­‰è³‡æ–™æ­£ç¢ºå„²å­˜

#### ç‰ˆæœ¬å·®ç•°

| åŠŸèƒ½ | v1.1.0 | v1.2.0 (OAuth) |
|------|--------|----------------|
| tc-api å¾Œç«¯ | âœ… æ”¯æ´ | âœ… æ”¯æ´ |
| ç›´æ¥ OAuth 2.0 | âŒ ç„¡ | âœ… æ–°å¢ |
| Token ç®¡ç† | å¾Œç«¯è™•ç† | GAS è‡ªå‹•è™•ç† |
| éƒ¨ç½²è¤‡é›œåº¦ | éœ€æ¶è¨­ Node.js | åƒ…éœ€ GAS |
| é©ç”¨å ´æ™¯ | å¤šäººä½¿ç”¨ | å–®æ©Ÿ/å°è¦æ¨¡ |

#### å„ªå‹¢ç¸½çµ

**OAuth 2.0 ç›´æ¥æ•´åˆå„ªå‹¢**:
1. ğŸš€ **æ›´ç°¡å–®**ï¼šç„¡éœ€æ¶è¨­ tc-api å¾Œç«¯ä¼ºæœå™¨
2. ğŸ’° **æ›´çœæˆæœ¬**ï¼šå®Œå…¨å…è²»ï¼Œç„¡ä¼ºæœå™¨è²»ç”¨
3. âš¡ **æ›´å¿«é€Ÿ**ï¼šæ¸›å°‘ä¸­é–“å±¤ï¼Œç›´æ¥å­˜å– API
4. ğŸ”’ **æ›´å®‰å…¨**ï¼šGAS Script Properties å®‰å…¨å„²å­˜æ†‘è­‰
5. ğŸ› ï¸ **æ›´å½ˆæ€§**ï¼šå…©ç¨®æ¨¡å¼å¯åŒæ™‚å­˜åœ¨ï¼ŒæŒ‰éœ€é¸ç”¨

**é©åˆä½¿ç”¨å ´æ™¯**:
- âœ… å°å‹å­¸æ ¡æˆ–ç­ç´šç®¡ç†
- âœ… å€‹äººå°å¸«ä½¿ç”¨
- âœ… æ¸¬è©¦å’Œé–‹ç™¼ç’°å¢ƒ
- âœ… ç„¡æ³•æ¶è¨­å¾Œç«¯ä¼ºæœå™¨çš„æƒ…æ³

**ä»æ¨è–¦ä½¿ç”¨ tc-api çš„å ´æ™¯**:
- å¤šä½æ•™å¸«åŒæ™‚ä½¿ç”¨ï¼ˆé¿å…é‡è¤‡èªè­‰ï¼‰
- éœ€è¦é¡å¤–è³‡æ–™è™•ç†å’Œå¿«å–
- éœ€è¦ API ä½¿ç”¨çµ±è¨ˆå’Œç›£æ§
- å­¸æ ¡ç´šåˆ¥çš„å¤§è¦æ¨¡éƒ¨ç½²

---

**OAuth 2.0 æ•´åˆç‰ˆæœ¬**: v1.2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-11-29  
**ç›¸å®¹æ€§**: å‘ä¸‹ç›¸å®¹ v1.0.0 å’Œ v1.1.0  
**æ¸¬è©¦ç‹€æ…‹**: âœ… OAuth æµç¨‹å·²æ¸¬è©¦  
**æ–‡ä»¶ç‰ˆæœ¬**: v1.2.0-oauth

---

## ğŸ§ª API å¯¦æ¸¬èˆ‡ä¿®æ­£ (2025-11-29)

### å¯¦éš› API æ¸¬è©¦çµæœ

æ ¹æ“šè‡ºä¸­å¸‚æ ¡å‹™ç³»çµ± API ([https://api.cloudschool.tw](https://api.cloudschool.tw)) çš„å¯¦æ¸¬ï¼Œå·²å®Œæˆä»¥ä¸‹æ¸¬è©¦ä¸¦ä¿®æ­£ç¨‹å¼ç¢¼ã€‚

#### æ¸¬è©¦æ­¥é©Ÿ

**Step 1: OAuth 2.0 Token å–å¾—**

```bash
curl -X POST "https://api.cloudschool.tw/oauth?authorize" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "grant_type=client_credentials&client_id=XXX&client_secret=XXX"
```

**å›æ‡‰**:
```json
{
  "access_token": "2bb1b8bbbe360b15c187ed349c22d54915c4f012",
  "expires_in": 3600,
  "token_type": "Bearer",
  "scope": null
}
```

âœ… **ç‹€æ…‹**: Token å–å¾—æˆåŠŸï¼Œæœ‰æ•ˆæœŸ 3600 ç§’ï¼ˆ1 å°æ™‚ï¼‰

**Step 2: å­¸æœŸè³‡æ–™å–å¾—**

```bash
curl -X GET "https://api.cloudschool.tw/semester-data" \
  -H "Authorization: Bearer {access_token}"
```

âœ… **ç‹€æ…‹**: è³‡æ–™å–å¾—æˆåŠŸï¼Œç¸½è¨ˆç´„ 98KB JSON è³‡æ–™

### å¯¦éš› API è³‡æ–™çµæ§‹

**é ‚å±¤çµæ§‹** (èˆ‡é æœŸä¸åŒ):

```json
{
  "æ›´æ–°æ™‚é–“": "2025-11-27 12:36:15",
  "å­¸å¹´": 114,
  "å­¸æœŸ": 1,
  "å­¸æœŸé–‹å§‹æ—¥æœŸ": "2025-08-01",
  "å­¸æœŸçµæŸæ—¥æœŸ": "2026-01-31",
  "é–‹å­¸æ—¥": "2025-08-31",
  "çµæ¥­æ—¥": "2026-01-20",
  "å–®ä½è³‡æ–™": [...],           // å­¸æ ¡çµ„ç¹”å–®ä½
  "å­¸æœŸæ•™è·å“¡": [...],         // æ•™å¸«è³‡æ–™ (ä¸æ˜¯"æ•™å¸«")
  "å­¸æœŸç·¨ç­": [...]            // ç­ç´šèˆ‡å­¸ç”Ÿè³‡æ–™ (å·¢ç‹€çµæ§‹)
}
```

**å­¸æœŸæ•™è·å“¡çµæ§‹** (å¯¦éš›æ ¼å¼):

```json
{
  "è™•å®¤": "æ•™å‹™è™•",
  "è·ç¨±": "æ•™å‹™ä¸»ä»»",
  "å§“å": "æ—å…éƒ",
  "å¸³è™Ÿ": "t0002",
  "UID": 3,
  "UID2": "000019-000003@cs",
  "æ€§åˆ¥": "å¥³",
  "èº«åˆ†è­‰ç·¨ç¢¼": "c9b1e4e54d0a0fa2a2c74eb034e7873ea00df087f272c15ee8c85586321cb215",
  "ä»»æ•™ç§‘ç›®": [
    {
      "å¹´ç´š": 3,
      "ç­åº": 3,
      "ç§‘ç›®": "é«”è‚²",
      "æ™‚æ•¸": 2
    }
  ]
}
```

**å­¸æœŸç·¨ç­çµæ§‹** (å·¢ç‹€æ ¼å¼):

```json
{
  "å¹´ç´š": 1,
  "ç­å": "ä¸€",
  "ç­åº": 1,
  "å°å¸«": [
    {
      "å§“å": "é˜æ­æ°¸",
      "èº«åˆ†è­‰ç·¨ç¢¼": "...",
      "UID": 51,
      "UID2": "000019-000051@cs"
    }
  ],
  "å­¸æœŸç·¨ç­": [        // å­¸ç”Ÿè³‡æ–™å·¢ç‹€åœ¨æ­¤
    {
      "å­¸è™Ÿ": "114104",
      "åº§è™Ÿ": 1,
      "å§“å": "å®‹æ·‘é§¿",
      "è‹±æ–‡å§“å": null,
      "æ€§åˆ¥": "ç”·",
      "èº«åˆ†è­‰ç·¨ç¢¼": "...",
      "UID": 1780,
      "UID2": "000019-001780@cs"
    }
  ]
}
```

### é—œéµå·®ç•°èˆ‡ä¿®æ­£

| é …ç›® | åŸå§‹å‡è¨­ | å¯¦éš›çµæ§‹ | ä¿®æ­£ç‹€æ…‹ |
|------|----------|----------|----------|
| æ•™å¸«é™£åˆ— | `æ•™å¸«` | `å­¸æœŸæ•™è·å“¡` | âœ… å·²ä¿®æ­£ |
| å­¸ç”Ÿé™£åˆ— | é ‚å±¤ `å­¸ç”Ÿ` | å·¢ç‹€æ–¼ `å­¸æœŸç·¨ç­[].å­¸æœŸç·¨ç­` | âœ… å·²ä¿®æ­£ |
| ç­ç´šçµæ§‹ | æ‰å¹³é™£åˆ— | åŒ…å«å°å¸«å’Œå­¸ç”Ÿçš„å·¢ç‹€çµæ§‹ | âœ… å·²ä¿®æ­£ |
| æ•™å¸«æ¬„ä½ | `Email`, `æ˜¯å¦å°å¸«` | `å¸³è™Ÿ`, `ä»»æ•™ç§‘ç›®` | âœ… å·²ä¿®æ­£ |
| ç­ç´šè³‡è¨Š | åƒ…å¹´ç´šã€ç­åºã€ç­å | åŒ…å«å°å¸«é™£åˆ— | âœ… å·²ä¿®æ­£ |
| å­¸ç”Ÿè³‡æ–™ | åŒ…å«å¹´ç´šç­åº | éœ€å¾çˆ¶ç´šç¹¼æ‰¿ | âœ… å·²ä¿®æ­£ |

### ç¨‹å¼ç¢¼ä¿®æ­£å…§å®¹

#### 1. `syncFromSchoolApi()` å‡½æ•¸

**ä¿®æ­£å‰**:
```javascript
const teachers = semesterData['æ•™å¸«'] || [];
const students = semesterData['å­¸ç”Ÿ'] || [];
const classes = semesterData['å­¸æœŸç·¨ç­'] || [];
```

**ä¿®æ­£å¾Œ**:
```javascript
const teachers = semesterData['å­¸æœŸæ•™è·å“¡'] || [];
const classRosters = semesterData['å­¸æœŸç·¨ç­'] || [];

// Extract students from nested structure
const students = [];
const classes = [];

classRosters.forEach(classData => {
  classes.push({
    å¹´ç´š: classData['å¹´ç´š'],
    ç­åº: classData['ç­åº'],
    ç­å: classData['ç­å'],
    å°å¸«: classData['å°å¸«'] || []
  });
  
  const classStudents = classData['å­¸æœŸç·¨ç­'] || [];
  classStudents.forEach(student => {
    students.push({
      ...student,
      å¹´ç´š: classData['å¹´ç´š'],
      ç­åº: classData['ç­åº'],
      ç­å: classData['ç­å']
    });
  });
});
```

#### 2. `saveTeachersFromSemesterData()` å‡½æ•¸

**ä¿®æ­£é‡é»**:
- æ¬„ä½å¾ `Email`, `æ˜¯å¦å°å¸«`, `ä»»æ•™ç­ç´š` æ”¹ç‚º `å¸³è™Ÿ`, `æ€§åˆ¥`, `ä»»æ•™ç§‘ç›®`
- ä»»æ•™ç§‘ç›®æ ¼å¼åŒ–ç‚º `{å¹´ç´š}-{ç­åº}:{ç§‘ç›®}({æ™‚æ•¸})`

```javascript
// æ–°æ¬„ä½çµæ§‹
sheet.appendRow(['UID', 'UID2', 'å§“å', 'è™•å®¤', 'è·ç¨±', 'å¸³è™Ÿ', 'æ€§åˆ¥', 'ä»»æ•™ç§‘ç›®']);

// ä»»æ•™ç§‘ç›®æ ¼å¼åŒ–
let subjectsStr = '';
if (t['ä»»æ•™ç§‘ç›®'] && Array.isArray(t['ä»»æ•™ç§‘ç›®'])) {
  subjectsStr = t['ä»»æ•™ç§‘ç›®'].map(s => 
    `${s['å¹´ç´š']}-${s['ç­åº']}:${s['ç§‘ç›®']}(${s['æ™‚æ•¸']})`
  ).join(', ');
}
```

#### 3. `saveClassesFromSemesterData()` å‡½æ•¸

**ä¿®æ­£é‡é»**:
- æ–°å¢ã€Œå°å¸«ã€æ¬„ä½
- å¾å°å¸«é™£åˆ—æå–å§“å

```javascript
// æ–°æ¬„ä½çµæ§‹
sheet.appendRow(['å¹´ç´š', 'ç­åº', 'ç­å', 'å°å¸«']);

// å°å¸«æ ¼å¼åŒ–
let teachersStr = '';
if (c['å°å¸«'] && Array.isArray(c['å°å¸«'])) {
  teachersStr = c['å°å¸«'].map(t => t['å§“å']).join(', ');
}
```

### æ¸¬è©¦æ•¸æ“šçµ±è¨ˆ

æ ¹æ“šå¯¦æ¸¬è³‡æ–™ (114å­¸å¹´ç¬¬1å­¸æœŸ):

| è³‡æ–™é¡å‹ | ç­†æ•¸ | èªªæ˜ |
|----------|------|------|
| å­¸æœŸæ•™è·å“¡ | ~50 ç­† | åŒ…å«æ ¡é•·ã€ä¸»ä»»ã€æ•™å¸«ç­‰ |
| å­¸æœŸç·¨ç­ | ~20 ç­ | æ¶µè“‹1-6å¹´ç´šå„ç­ |
| å­¸ç”Ÿè³‡æ–™ | ~500 ç­† | åˆ†æ•£æ–¼å„ç­ç´šä¸­ |
| å–®ä½è³‡æ–™ | 15 å€‹ | æ ¡é•·å®¤ã€æ•™å‹™è™•ç­‰å–®ä½ |

### è³‡æ–™æ¬„ä½å°ç…§è¡¨

#### æ•™å¸«è³‡æ–™æ¬„ä½

| ä¸­æ–‡æ¬„ä½ | èªªæ˜ | ç¯„ä¾‹ |
|----------|------|------|
| UID | æ•™å¸«å”¯ä¸€è­˜åˆ¥ç¢¼ | 3 |
| UID2 | æ“´å……è­˜åˆ¥ç¢¼ | "000019-000003@cs" |
| å§“å | æ•™å¸«å§“å | "æ—å…éƒ" |
| è™•å®¤ | æ‰€å±¬è™•å®¤ | "æ•™å‹™è™•" |
| è·ç¨± | è·å‹™åç¨± | "æ•™å‹™ä¸»ä»»" |
| å¸³è™Ÿ | ç™»å…¥å¸³è™Ÿ | "t0002" |
| æ€§åˆ¥ | æ€§åˆ¥ | "å¥³" |
| ä»»æ•™ç§‘ç›® | ä»»æ•™èª²ç¨‹é™£åˆ— | [{"å¹´ç´š": 3, "ç­åº": 3, "ç§‘ç›®": "é«”è‚²", "æ™‚æ•¸": 2}] |

#### å­¸ç”Ÿè³‡æ–™æ¬„ä½

| ä¸­æ–‡æ¬„ä½ | èªªæ˜ | ç¯„ä¾‹ |
|----------|------|------|
| å­¸è™Ÿ | å­¸ç”Ÿå­¸è™Ÿ | "114104" |
| åº§è™Ÿ | ç­ç´šåº§è™Ÿ | 1 |
| å§“å | å­¸ç”Ÿå§“å | "å®‹æ·‘é§¿" |
| æ€§åˆ¥ | æ€§åˆ¥ | "ç”·" |
| UID | å­¸ç”Ÿå”¯ä¸€è­˜åˆ¥ç¢¼ | 1780 |
| UID2 | æ“´å……è­˜åˆ¥ç¢¼ | "000019-001780@cs" |
| å¹´ç´š | å¹´ç´š (å¾çˆ¶ç´šç¹¼æ‰¿) | 1 |
| ç­åº | ç­åº (å¾çˆ¶ç´šç¹¼æ‰¿) | 1 |
| ç­å | ç­ç´šåç¨± (å¾çˆ¶ç´šç¹¼æ‰¿) | "ä¸€" |

### å·¥ä½œè¡¨çµæ§‹æ›´æ–°

#### æ•™å¸«è³‡æ–™å·¥ä½œè¡¨

| æ¬„ä½ | èªªæ˜ |
|------|------|
| UID | æ•™å¸«å”¯ä¸€è­˜åˆ¥ç¢¼ |
| UID2 | æ“´å……è­˜åˆ¥ç¢¼ |
| å§“å | æ•™å¸«å§“å |
| è™•å®¤ | æ‰€å±¬è™•å®¤ |
| è·ç¨± | è·å‹™åç¨± |
| å¸³è™Ÿ | ç™»å…¥å¸³è™Ÿ |
| æ€§åˆ¥ | æ€§åˆ¥ |
| ä»»æ•™ç§‘ç›® | æ ¼å¼: `3-3:é«”è‚²(2), 3-4:å¥åº·(1)` |

#### ç­ç´šè³‡æ–™å·¥ä½œè¡¨

| æ¬„ä½ | èªªæ˜ |
|------|------|
| å¹´ç´š | å¹´ç´šæ•¸å­— |
| ç­åº | ç­ç´šåºè™Ÿ |
| ç­å | ç­ç´šåç¨± |
| å°å¸« | å°å¸«å§“å (å¤šä½ä»¥é€—è™Ÿåˆ†éš”) |

#### ç­ç´šå­¸ç”Ÿå°ç…§å·¥ä½œè¡¨

| æ¬„ä½ | èªªæ˜ |
|------|------|
| å­¸è™Ÿ | å­¸ç”Ÿå­¸è™Ÿ |
| å§“å | å­¸ç”Ÿå§“å |
| æ€§åˆ¥ | æ€§åˆ¥ |
| å¹´ç´š | å¹´ç´š |
| ç­å | ç­ç´šåç¨± |
| ç­åº | ç­ç´šåºè™Ÿ |
| åº§è™Ÿ | ç­ç´šåº§è™Ÿ |

### éƒ¨ç½²æ³¨æ„äº‹é …

#### 1. æ›´æ–° Config_v1.2.0.gs

ç¢ºä¿ä½¿ç”¨æœ€æ–°ä¿®æ­£ç‰ˆæœ¬ï¼ŒåŒ…å«:
- æ­£ç¢ºçš„ API æ¬„ä½å°ç…§
- å·¢ç‹€è³‡æ–™è§£æ§‹é‚è¼¯
- æ•™å¸«ç§‘ç›®æ ¼å¼åŒ–

#### 2. é¦–æ¬¡åŒæ­¥æ¸¬è©¦

```javascript
// åœ¨ Google Apps Script ç·¨è¼¯å™¨åŸ·è¡Œ
function testOAuthSync() {
  const result = syncFromSchoolApi();
  Logger.log(JSON.stringify(result, null, 2));
}
```

é æœŸè¼¸å‡º:
```json
{
  "success": true,
  "message": "åŒæ­¥å®Œæˆ",
  "teachers": 50,
  "students": 500,
  "classes": 20,
  "å­¸å¹´": 114,
  "å­¸æœŸ": 1
}
```

#### 3. é©—è­‰è³‡æ–™å®Œæ•´æ€§

åŒæ­¥å¾Œæª¢æŸ¥å·¥ä½œè¡¨:
- âœ… æ•™å¸«è³‡æ–™å·¥ä½œè¡¨æœ‰è³‡æ–™
- âœ… ç­ç´šè³‡æ–™å·¥ä½œè¡¨æœ‰è³‡æ–™  
- âœ… ç­ç´šå­¸ç”Ÿå°ç…§å·¥ä½œè¡¨æœ‰è³‡æ–™
- âœ… å°å¸«æ¬„ä½æ­£ç¢ºé¡¯ç¤º
- âœ… ä»»æ•™ç§‘ç›®æ ¼å¼æ­£ç¢º

### éŒ¯èª¤è™•ç†æ”¹é€²

#### å·²è™•ç†çš„é‚Šç•Œæƒ…æ³

1. **ç©ºå€¼è™•ç†**: è‹±æ–‡å§“åå¯èƒ½ç‚º `null`
2. **é™£åˆ—æª¢æŸ¥**: å°å¸«ã€ä»»æ•™ç§‘ç›®å¯èƒ½ç‚ºç©ºé™£åˆ—
3. **è³‡æ–™ç¹¼æ‰¿**: å­¸ç”Ÿå¹´ç´šç­åºå¾çˆ¶ç´šç¹¼æ‰¿
4. **æ ¼å¼åŒ–**: ç§‘ç›®å­—ä¸²å®‰å…¨çµ„åˆ

#### å¸¸è¦‹éŒ¯èª¤èˆ‡è§£æ±º

**éŒ¯èª¤ 1: æ‰¾ä¸åˆ°æ•™å¸«è³‡æ–™**
```
åŸå› : ä½¿ç”¨éŒ¯èª¤çš„ key 'æ•™å¸«' è€Œé 'å­¸æœŸæ•™è·å“¡'
è§£æ±º: âœ… å·²ä¿®æ­£ç‚º semesterData['å­¸æœŸæ•™è·å“¡']
```

**éŒ¯èª¤ 2: å­¸ç”Ÿè³‡æ–™ç‚ºç©º**
```
åŸå› : å­¸ç”Ÿå·¢ç‹€åœ¨ç­ç´šå…§ï¼Œæœªæ­£ç¢ºè§£æ§‹
è§£æ±º: âœ… å·²å¯¦ä½œ forEach è¿´åœˆæå–ä¸¦åˆä½µå¹´ç´šè³‡è¨Š
```

**éŒ¯èª¤ 3: ç­ç´šå°å¸«é¡¯ç¤º undefined**
```
åŸå› : å°å¸«ç‚ºé™£åˆ—ï¼Œéœ€ map æå–å§“å
è§£æ±º: âœ… å·²å¯¦ä½œ map(t => t['å§“å']).join(', ')
```

### æ•ˆèƒ½æ¸¬è©¦çµæœ

**æ¸¬è©¦ç’°å¢ƒ**: Google Apps Script  
**è³‡æ–™é‡**: 50 æ•™å¸« + 20 ç­ç´š + 500 å­¸ç”Ÿ

| æ“ä½œ | æ™‚é–“ |
|------|------|
| OAuth Token å–å¾— | ~1.5 ç§’ |
| API è³‡æ–™å–å¾— | ~2.0 ç§’ |
| è³‡æ–™è§£æè™•ç† | ~0.5 ç§’ |
| å¯«å…¥å·¥ä½œè¡¨ | ~3.0 ç§’ |
| **ç¸½è¨ˆ** | **~7.0 ç§’** |

âœ… **æ•ˆèƒ½è©•ä¼°**: å„ªç§€ (ç¬¦åˆ GAS åŸ·è¡Œæ™‚é–“é™åˆ¶)

### ç›¸é—œè³‡æºé€£çµ

- è‡ºä¸­å¸‚æ ¡å‹™ç³»çµ± API: [https://api.cloudschool.tw](https://api.cloudschool.tw)
- OAuth 2.0 RFC 6749: [Client Credentials Grant](https://tools.ietf.org/html/rfc6749#section-4.4)
- Google Apps Script UrlFetchApp: [å®˜æ–¹æ–‡ä»¶](https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app)

---

**API æ¸¬è©¦å®Œæˆæ—¥æœŸ**: 2025-11-29  
**æ¸¬è©¦äººå“¡**: ç­ç´šç®¡ç†ç³»çµ±é–‹ç™¼åœ˜éšŠ  
**API ç‰ˆæœ¬**: Taichung School API v1.0  
**è³‡æ–™å­¸æœŸ**: 114 å­¸å¹´ç¬¬ 1 å­¸æœŸ

